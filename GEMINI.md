# GEMINI Context for IKAO-OFIQ Project

Этот проект представляет собой C# ( .NET ) обертку над библиотекой **OFIQ** (Open Source Face Image Quality), работающую исключительно под Linux.

## Обзор проекта
Проект разделен на две основные части:
1. **Нативный мост (C++ Bridge)**: Файл `ofiq_bridge.cpp`. Он необходим для преобразования сложных типов C++ (std::shared_ptr, std::map) в структуры, совместимые с C# P/Invoke.
2. **C# Приложение**: Проект в директории `OFIQConsoleApp` (название проекта `IKAO-Images.csproj`), который загружает изображения через `SixLabors.ImageSharp` и вызывает нативные функции через `NativeInvoke.cs`.

## Ключевые файлы
- `ofiq_bridge.cpp`: C-совместимая обертка для `libofiq_lib.so`.
- `OFIQConsoleApp/Program.cs`: Основная точка входа, обрабатывающая аргументы командной строки и выводящая результаты.
- `OFIQConsoleApp/NativeInvoke.cs`: Определения P/Invoke, структур и перечислений для взаимодействия с мостом.
- `setup.sh`: Скрипт для сборки всего проекта "под ключ" на Linux.
- `libofiq_lib.so` & `libonnxruntime.so.1.18.1`: Оригинальные скомпилированные библиотеки OFIQ.

## Сборка и запуск
Сборка осуществляется на Linux при наличии GCC и .NET SDK:
```bash
./setup.sh
```
Запуск (из папки публикации):
```bash
./IKAO-Images <путь_к_фото> [путь_к_конфигу]
```

## Технологический стек
- **C++**: Для взаимодействия с оригинальной библиотекой.
- **C# / .NET 10.0**: Основной интерфейс приложения.
- **SixLabors.ImageSharp**: Для кроссплатформенной обработки изображений (преобразование в BGR24).

## Конвенции разработки
- Любые изменения в интерфейсе `libofiq_lib.so` должны отражаться в `ofiq_bridge.cpp` и затем в `NativeInvoke.cs`.
- Изображения всегда передаются в нативный код как плоский массив байтов в формате BGR (24 бита на пиксель).
